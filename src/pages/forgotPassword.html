<!DOCTYPE html>
<html>
  <head>
    <title>Histo Atlas - Mot de passe oublié</title>
    <link rel="icon" type="image/png" href="../img/icon.png" />
  </head>
  <body>

  <script type="text/javascript" src="../node_modules/jquery/dist/jquery.min.js"></script>

  <link rel="stylesheet" href="../index.css" />

  <p><a href="../index.html">Retour au menu</a></p>

  <h3>Mot de passe oublié</h3>
  <p>Entrer votre nom d'utilisateur, vous recevrez un mail permettant de réinitialiser votre mot de passe.</p>
  <label for="name">Votre nom d'utilisateur : </label><br/><input id="name" type="text" style="width: 250px;"></input><br/><br/>
  <button id="sendButton" style="width : 200px; height: 30px">Récupérer</button>

  <script type="text/javascript" src="../config/config.js"></script>

  <script>

    Config.load(true).then((config) =>
    {

      $("#sendButton").click(function() 
      {
        let name = $("#name").val();

        if(name.length == 0)
        {
          alert("Nom d'utilisateur vide");
        }
        else
        {
          let urlServer = config.serverUrl + "/api/user/forgotPassword";

          $.ajax({
            url: urlServer,
            method: "POST",
            contentType: "application/json",
            data: JSON.stringify({userName : name}),
            success: (response) => {

              alert("Mail envoyé pour changer votre mot de passe");
              window.location.href = "../index.html";
            },
            error: (err) => {
              alert("Echec de l'envoit du mail de récupération de mot de passe : " + err.responseJSON.error);
            }
          });
        }
      });
    });

  </script>

  </body>
</html>